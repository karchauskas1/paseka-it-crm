# üî¥ HOTFIX: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ (production)

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤ –∫–æ–¥–µ

–û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –ë–î, –≥–¥–µ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª–µ `socialLinks`:

#### [app/clients/page.tsx](app/clients/page.tsx)
- –î–æ–±–∞–≤–ª–µ–Ω –º–∞–ø–ø–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- –ï—Å–ª–∏ `socialLinks` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ë–î, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`

#### [app/api/clients/route.ts](app/api/clients/route.ts)
- GET endpoint —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ `socialLinks` –∏ `customFields` –≤ –æ—Ç–≤–µ—Ç–µ

#### [app/api/clients/[id]/route.ts](app/api/clients/[id]/route.ts)
- GET endpoint –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏—è

### 2. –°–æ–∑–¥–∞–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

–§–∞–π–ª: [scripts/check-production-db.md](scripts/check-production-db.md)

–°–æ–¥–µ—Ä–∂–∏—Ç 3 —Å–ø–æ—Å–æ–±–∞ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã:
1. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `npx prisma migrate deploy`
2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π**: –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SQL —Å–∫—Ä–∏–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ psql/pgAdmin
3. **–í—Ä–µ–º–µ–Ω–Ω—ã–π**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –≤ –∫–æ–¥–µ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

---

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ production

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ production —Å–µ—Ä–≤–µ—Ä—É:
   ```bash
   ssh user@pasekait-crm.ru
   ```

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:
   ```bash
   cd /path/to/paseka-crm
   ```

3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
   ```bash
   npx prisma migrate deploy
   ```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   # –î–ª—è Vercel - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
   # –î–ª—è PM2:
   pm2 restart paseka-crm

   # –î–ª—è Docker:
   docker-compose restart
   ```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SQL (–µ—Å–ª–∏ –Ω–µ—Ç SSH)

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL –ë–î —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª–µ social_links
SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name = 'clients' AND column_name = 'social_links';

-- –ï—Å–ª–∏ –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ:
ALTER TABLE clients ADD COLUMN IF NOT EXISTS social_links JSONB DEFAULT '[]';

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ feedbacks
SELECT EXISTS (
  SELECT FROM information_schema.tables
  WHERE table_name = 'feedbacks'
);
```

### –í–∞—Ä–∏–∞–Ω—Ç –í: –î–µ–ø–ª–æ–π —Ç–µ–∫—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

–¢–µ–∫—É—â–∏–π –∫–æ–¥ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç fallback –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –æ—à–∏–±–∫–∏.

**–î–ª—è Vercel/Netlify:**
```bash
# –°–¥–µ–ª–∞–π—Ç–µ commit –∏–∑–º–µ–Ω–µ–Ω–∏–π
git add .
git commit -m "Add fallback for socialLinks field (production hotfix)"
git push origin main

# Vercel/Netlify –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ—è—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

**–î–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:**
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
scp -r * user@pasekait-crm.ru:/path/to/app/
ssh user@pasekait-crm.ru "cd /path/to/app && pm2 restart paseka-crm"
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª—é–±–æ–≥–æ –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ [www.pasekait-crm.ru/clients](https://www.pasekait-crm.ru/clients) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ –°–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## –î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫

### –ì–¥–µ –Ω–∞–π—Ç–∏ –ª–æ–≥–∏:

**Vercel:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://vercel.com/your-project/deployments
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "Logs"

**Netlify:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://app.netlify.com/sites/your-site/deploys
2. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
3. –û—Ç–∫—Ä–æ–π—Ç–µ "Function logs"

**PM2:**
```bash
pm2 logs paseka-crm --lines 100
```

**Docker:**
```bash
docker logs paseka-crm-container --tail 100
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:

- `column "social_links" does not exist` - –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ë–î
- `relation "feedbacks" does not exist` - —Ç–∞–±–ª–∏—Ü–∞ feedback –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
- `invalid input syntax for type json` - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ

---

## –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| [app/clients/page.tsx](app/clients/page.tsx) | –î–æ–±–∞–≤–ª–µ–Ω –º–∞–ø–ø–∏–Ω–≥ —Å fallback –¥–ª—è socialLinks –∏ customFields |
| [app/api/clients/route.ts](app/api/clients/route.ts) | GET endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å fallback |
| [app/api/clients/[id]/route.ts](app/api/clients/[id]/route.ts) | GET endpoint –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —Å fallback |
| [scripts/check-production-db.md](scripts/check-production-db.md) | –ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –º–∏–≥—Ä–∞—Ü–∏–π |
| [HOTFIX_PRODUCTION.md](HOTFIX_PRODUCTION.md) | –≠—Ç–æ—Ç —Ñ–∞–π–ª - –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è |

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è production –æ—à–∏–±–∫–∏, —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:

1. ‚úÖ **HOTFIX –∑–∞–≤–µ—Ä—à—ë–Ω** - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å NotificationBell –≤ header
3. ‚è≥ –°–æ–∑–¥–∞—Ç—å Telegram –±–æ—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
4. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ website –≤ Client model
5. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UI –¥–ª—è customFields
6. ‚è≥ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å AI —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–æ—Å—Ç—É–ø–µ–Ω –≤ [/Users/karchauskas/.claude/plans/kind-whistling-quail.md](/Users/karchauskas/.claude/plans/kind-whistling-quail.md)
